[gd_scene load_steps=13 format=3 uid="uid://dqcd76r3cqo51"]

[ext_resource type="PackedScene" uid="uid://ctkjleksayrx3" path="res://scenes/Player.tscn" id="1_yaisc"]
[ext_resource type="PackedScene" uid="uid://d4fh75vgy62r0" path="res://scenes/TestLevel.tscn" id="2_3dt81"]
[ext_resource type="MeshLibrary" uid="uid://vfnrfdp7v5ww" path="res://textures/vent_pieces/VentPieces.tres" id="2_utfft"]
[ext_resource type="Script" path="res://scripts/Level.gd" id="3_rll2r"]
[ext_resource type="Script" path="res://scripts/Enemy.gd" id="5_6oajw"]
[ext_resource type="Script" path="res://scripts/MinimapRT.gd" id="5_sleny"]
[ext_resource type="Script" path="res://scripts/EnemyAI.gd" id="6_nn3ox"]

[sub_resource type="Environment" id="Environment_ei365"]
background_mode = 1
background_color = Color(0.164706, 0.654902, 0, 1)

[sub_resource type="SphereMesh" id="SphereMesh_xyyc7"]

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_t0u1w"]
points = PackedVector3Array(0.457871, 0.198079, 0.0157824, -0.48874, -0.0916874, -0.0451868, -0.471509, -0.137027, -0.0907015, 0.0763591, -0.333275, 0.364179, 0.136569, -0.332425, -0.346906, -0.151617, 0.471982, -0.0602459, -0.105347, 0.211936, 0.43966, -0.0450169, 0.198098, -0.456416, 0.409077, -0.151168, 0.242516, -0.271376, -0.377761, 0.181871, 0.41148, -0.075981, -0.27324, 0.198197, -0.456161, -0.044931, -0.240641, -0.331674, -0.285768, 0.227137, 0.25672, 0.363041, 0.227522, 0.423604, -0.135488, -0.37899, 0.0607022, 0.319462, -0.406747, 0.181049, -0.225691, -0.0146313, -0.0917695, 0.490229, -0.377855, 0.302793, 0.121712, 0.0462323, 0.456011, 0.198185, -0.227464, -0.0607863, -0.440348, 0.228455, 0.0607228, -0.439887, -0.0911376, -0.489246, -0.045174, 0.441865, -0.228216, -0.0449581, 0.317179, 0.241214, -0.300812, -0.0448487, 0.394737, -0.302955, -0.316348, -0.196222, 0.332551, 0.198442, -0.0304293, 0.457237, 0.0614714, -0.152246, -0.471307, 0.363089, 0.256708, 0.227079, 0.152134, -0.439489, 0.182379, -0.210725, 0.362276, 0.27223)

[sub_resource type="Sky" id="Sky_m57rc"]

[sub_resource type="Environment" id="Environment_uog4n"]
background_mode = 1
sky = SubResource("Sky_m57rc")
sky_custom_fov = 70.1

[node name="TestWorld" type="Node3D"]

[node name="Level" parent="." instance=ExtResource("2_3dt81")]
transform = Transform3D(1, 0, 0, 0, 0.999826, 0.0186739, 0, -0.0186739, 0.999826, 0, 0, 0)
mesh_library = ExtResource("2_utfft")
cell_center_x = false
cell_center_z = false
data = {
"cells": PackedInt32Array(2, 65535, 1441796, 0, 65535, 1441796, 65534, 65535, 1441796, 65532, 65535, 1441796, 65530, 65535, 1441796, 65528, 65535, 1441796, 65526, 65535, 1441796, 65524, 65535, 1441796, 65522, 65535, 1441796, 65520, 65535, 1441796, 65518, 65535, 655363, 65518, 1, 655364, 65518, 3, 655364, 65518, 5, 1441795, 65520, 5, 1441796, 65522, 5, 1441796, 65524, 5, 1441796, 65526, 5, 1441796, 65528, 5, 1441796, 65530, 5, 1441796, 65532, 5, 1441796, 65534, 5, 1441796, 0, 5, 1441796, 2, 5, 1441796, 4, 5, 1441796, 6, 5, 3, 6, 3, 4, 6, 1, 4, 6, 65535, 1048579, 4, 65535, 1048580)
}
script = ExtResource("3_rll2r")
metadata/_editor_floor_ = Vector3(0, 0, 0)

[node name="Player" parent="." instance=ExtResource("1_yaisc")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2, 0.5, -1)

[node name="MinimapCameraRT" type="RemoteTransform3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 5, 1)
remote_path = NodePath("../../MinimapViewportContainer/MinimapViewport/MinimapCamera")
script = ExtResource("5_sleny")

[node name="MinimapPlayerLightRT" type="RemoteTransform3D" parent="Player"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 0, 0, 0)
remote_path = NodePath("../../MinimapViewportContainer/MinimapViewport/MinimapPlayerLight")
script = ExtResource("5_sleny")

[node name="Environment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_ei365")

[node name="Enemy" type="CharacterBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, 5)
script = ExtResource("5_6oajw")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Enemy"]
mesh = SubResource("SphereMesh_xyyc7")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Enemy"]
shape = SubResource("ConvexPolygonShape3D_t0u1w")
disabled = true

[node name="EnemyAI" type="Node" parent="." node_paths=PackedStringArray("enemy", "level", "player")]
script = ExtResource("6_nn3ox")
enemy = NodePath("../Enemy")
level = NodePath("../Level")
player = NodePath("../Player")

[node name="MinimapViewportContainer" type="SubViewportContainer" parent="."]
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -2.0
offset_right = 206.0
offset_bottom = 205.0
grow_horizontal = 0
rotation = 1.5708
stretch = true

[node name="MinimapViewport" type="SubViewport" parent="MinimapViewportContainer"]
handle_input_locally = false
size = Vector2i(208, 205)
render_target_update_mode = 4

[node name="MinimapCamera" type="Camera3D" parent="MinimapViewportContainer/MinimapViewport"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 2, 5.5, 0)
cull_mask = 512
environment = SubResource("Environment_uog4n")
h_offset = -5.0
current = true

[node name="MinimapPlayerLight" type="SpotLight3D" parent="MinimapViewportContainer/MinimapViewport"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 2, 0.5, -1)
layers = 512
light_color = Color(0.992157, 1, 0.803922, 1)
light_indirect_energy = 4.995
spot_range = 20.0
